@font-face {
    font-family: "Sixtyfour";
    src: url(assets/Sixtyfour-Variable.ttf);
}
:root { font: 1rem/1 system-ui }
*, *::before, *::after {
    box-sizing: border-box;
}
html { 
    font: 1rem/1 Inter, Roboto, 'Helvetica Neue', 'Arial Nova', 'Nimbus Sans', Arial, sans-serif;
    font-family: sans-serif;
    color: oklch(95% 0.15 285);
    fill: oklch(95% 0.15 285);
}
body { 
    margin: 0;
    background-image: url(assets/gloop.png);
    background-size: 400px;
    min-height: 100svh;
    display: flex;
    flex-direction: column;
}
h1 {
    color: oklch(75% 0.15 170);
    font-size: 3rem;
    text-align: center;
    margin-block-end: 0;
    font-family: "Sixtyfour";
    font-variation-settings: "BLED" 22, "SCAN" -30;
    animation: pulsate 5s infinite linear;
}
@keyframes pulsate {
    0% {
        text-shadow: oklch(75% 0.15 170) 0px 0px 0.5em;
    }
    50% {
        text-shadow: oklch(75% 0.15 170) 0px 0px 0.15em;
    }
    100% {
        text-shadow: oklch(75% 0.15 170) 0px 0px 0.5em;
    }
}
main {
    padding: 2rem;
}
iframe[src*="youtube.com/embed"], div#yt { display: none }

@keyframes spin {
    from { rotate:   0deg }
    to   { rotate: 360deg }
}
music-player {
    accent-color: oklch(65% 0.15 285);
    padding: 2rem;
    display: flex;
    flex-direction: row-reverse;
    flex-wrap: wrap;
    gap: 2rem 0;
    max-width: 80rem;
    margin-inline: auto;
    border-radius: 1.5rem;
    border: 1px solid oklch(35% 0.1 285);
    backdrop-filter: blur(5px);
    background-image: url(assets/noise.png);
    background-position: center;
    background-color: oklch(35% 0.1 285 / 35%);

    & button {
        border-radius: 50%;
        outline-offset: -4px;
        & svg {
            transition: fill .1s;
        }
        &:is(:hover, :focus-visible):not(:disabled) svg {
            fill: oklch(65% 0.15 285);
        }
    }

    & .track-list {
        flex-grow: 2;
        list-style: none;
        margin: 0;
        padding: 0;
        display: flex;
        flex-direction: column;
        max-width: 40rem;

        & li {
            display: flex;
            padding: .35rem;
            border-radius: .85rem;
            background-color: transparent;
            transition: background-color .1s;
            align-items: center;
            gap: .65rem;

            &:hover, &:has(:focus-visible) {
                background-color:  oklch(40% 0.1 285 / 35%);
            }

            & .thumbnail {
                flex-shrink: 0;
                background-position: center;
                background-size: cover;
                background-repeat: no-repeat;
                width: 3rem;
                height: 3rem;
                grid-column: 1;
                grid-row: span 2;
                border-radius: .5rem;
                outline: 1px solid oklch(35% 0.1 285);
            }
            & .info {
                flex-shrink: 1;
                & .title {
                    font-weight: 600;
                    height: 1em;
                    overflow: clip;
                }
                & .artist {
                    height: 1em;
                    overflow: clip;
                    font-size: 90%;
                }
            }
            
            & [is=play-track] {
                flex-shrink: 0;
                cursor: pointer;
                width: 3rem;
                height: 3rem;
                appearance: none;
                background: none;
                padding: 0;
                font-size: 0;
                border: 0;
                display: flex;
                align-items: center;
                justify-content: center;
                margin-inline-start: auto;
                & svg {
                    display: none;
                    width: 75%;
                    height: 75%;
                }
                &:disabled {
                    cursor: default;
                    opacity: 50%;
                }
            }
            & .vibes {
                display: none
            }
            &:not(.selected) [is=play-track] svg.not-playing {
                display: block;
            }
        }
    }
    & music-controls {
        height: fit-content;
        flex-grow: 1;
        display: grid;
        grid-template-columns: 1fr max-content 1fr;
        grid-auto-rows: max-content;
        gap: .25rem;
        & .album-art {
            grid-column: span 3;
            justify-self: center;
            background-size: cover;
            background-repeat: no-repeat;
            background-position: center;
            border: 1px solid oklch(35% 0.1 285);
            max-width: min(50vh, 20rem);
            max-height: min(50vh, 20rem);
            width: 50%;
            aspect-ratio: 1;
            border-radius: 50%;
            box-shadow: 0 0 1rem 0 transparent;
            transition: box-shadow .2s;
            animation: spin 30s infinite linear;
            animation-play-state: paused;
            will-change: rotate;
        }
        & .title, .artist {
            grid-column: span 3;
            height: 1rem;
            justify-self: center;
            white-space: nowrap;
            overflow-x: clip;
            text-overflow: ellipsis;
            
            &.title {
                margin-block-start: 1rem;
                height: 1em;
                font-weight: 600;
            }
            & .artist {
                font-size: 90%;
                height: 1em
            }
        }
        & button {
            appearance: none;
            background: none;
            padding: 0;
            font-size: 0;
            border: 0;
            cursor: pointer;
            align-self: center;

            &[is=next-button],
            &[is=previous-button] {
                height: 3rem;
                width: 3rem;
                padding: .5rem;
                &:disabled {
                    visibility: hidden;
                }
            }
            &[is=previous-button] {
                justify-self: end;
            }
            &[is=play-button] {
                justify-self: center;
                width: 4rem;
                height: 4rem;
                padding: .5rem;
                &:disabled {
                    cursor: default;
                    opacity: 50%;
                }
                & svg {
                    display: none;
                }
            }
            &[is=next-button] {
                justify-self: start;
            }

            & svg {
                width: 100%;
                height: 100%;
            }
        }
        & music-progress {
            grid-column: span 3;
            display: flex;
            flex-direction: row-reverse;
            flex-wrap: wrap;
            gap: 0 .25rem;
            align-items: center;
            & span, div {
                flex-basis: 13ch;
                flex-shrink: 0;
            }
            & input[type=range] {
                flex-grow: 1;
                flex-shrink: 1;
                cursor: pointer;
                min-width: 15rem;
                &:active {
                    cursor: grabbing;
                    &::-webkit-slider-thumb {
                        cursor: grabbing;
                    }
                    &::-moz-range-thumb {
                        cursor: grabbing;
                    }
                }
                &:disabled {
                    cursor: default;
                }
                &::-webkit-slider-thumb {
                    cursor: grab;
                }
                &::-moz-range-thumb {
                    cursor: grab;
                }
            }
            & div {
                font-size: 90%;
                font-weight: 500;
                white-space: nowrap;
                text-align: center;
                margin-block: .25rem;
            }
            
        }
    }
    &[state=not-playing] {
        .track-list [is=play-track] {
            cursor: pointer;
            & svg.not-playing {
                display: block;
            }
        }

        /* reset animation state on song change */
        & music-controls .album-art {
            animation: none;
        }
        &  music-controls [is=play-button] {
            opacity: 50%;
            cursor: default;
            & svg.not-playing {
                display: block;
            }
        }
    }
    &[state=buffering] {
        .track-list .selected [is=play-track] {
            cursor: wait;
            & svg.buffering {
                display: block;
            }
        }
        & [is=play-button] svg.buffering {
            display: block;
        }
    }
    &[state=playing] {
        .track-list .selected [is=play-track] {
            cursor: pointer;
            & svg.playing {
                display: block;
            }
        }
        & music-controls .album-art {
            animation-play-state: running;
            box-shadow: 0 0 1rem 0 hsl(250, 60%, 70%);
        }
        & [is=play-button] svg.playing {
            display: block;
        }
    }
    &[state=paused] {
        .track-list .selected [is=play-track] {
            cursor: pointer;
            & svg.paused {
                display: block;
            }
        }
        & [is=play-button] svg.paused {
            display: block;
        }
    }
}

@media (width < 800px) {
    main {
        padding-inline: 1rem;
    }
    music-player {
        padding: .5rem;
        border-radius: 1rem;
        & music-controls {
            padding: 1.5rem 1.5rem 0 1.5rem;
        }
    }
}